<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!-- <script src="//cdn.jsdelivr.net/npm/eruda"></script>
    <script>eruda.init();</script> -->
    <title>Document</title>
</head>
<style>
    p {
        margin: 0.1rem;
        font-size: 0.7rem;
    }

    #textarea {
        width: 20rem;
        height: 20rem;
        background-color: #333;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        border-radius: 7px;
        touch-action: none;
    }

    .close {
        background-image: url(https://cdn-icons-png.flaticon.com/512/463/463612.png);
        background-repeat: no-repeat;
        background-size: contain;
        width: 1rem;
        height: 1rem;
    }

    .item0 {
        width: 5rem;
        height: 5rem;
        background-image: url(https://cdn-icons-png.flaticon.com/512/2662/2662908.png);
        background-repeat: no-repeat;
        background-size: contain;
        border-radius: 50%;
        touch-action: none;
        user-select: none;
        z-index: 1;
        position: absolute;
    }

    .item0:active {
        background-color: rgba(168, 218, 220, 1.00);
        position: relative;
    }

    .item1 {
        width: 5rem;
        height: 5rem;
        background-image: url(https://cdn-icons-png.flaticon.com/512/733/733740.png);
        background-repeat: no-repeat;
        background-size: contain;
        border-radius: 50%;
        touch-action: none;
        user-select: none;
        z-index: 1;
        position: absolute;
    }

    .item1:active {
        background-color: rgba(168, 218, 220, 1.00);
        position: relative;
    }

    .item2 {
        width: 5rem;
        height: 5rem;
        background-image: url(https://cdn-icons-png.flaticon.com/512/2920/2920093.png);
        background-repeat: no-repeat;
        background-size: contain;
        border-radius: 50%;
        touch-action: none;
        user-select: none;
        z-index: 1;
        position: absolute;
    }

    .item2:active {
        background-color: rgba(168, 218, 220, 1.00);
        position: relative;
    }


    .textbox {
        position: absolute;
        text-align: left;
        border: 2px solid black;
        border-radius: 2%;
        resize: none;
        display: flex;
        margin: auto;
        width: 15rem;
        height: 15rem;
        padding: 1rem;

    }

    .btn0 {
        background-image: url(https://cdn-icons-png.flaticon.com/512/2662/2662908.png);
        background-repeat: no-repeat;
        background-size: contain;
        width: 3rem;
        height: 3rem;
        border: none;
        background-color: transparent;
        transition: all ease 1s;
    }

    .btn0_1 {
        opacity: 0;
        pointer-events: none;
        background-image: url(https://cdn-icons-png.flaticon.com/512/2662/2662908.png);
        background-repeat: no-repeat;
        background-size: contain;
        width: 3rem;
        height: 3rem;
        border: none;
        background-color: transparent;
        transition: all ease 1s;
    }

    .btn1 {
        background-image: url(https://cdn-icons-png.flaticon.com/512/733/733740.png);
        background-repeat: no-repeat;
        background-size: contain;
        width: 3rem;
        height: 3rem;
        border: none;
        background-color: transparent;
        transition: all ease 1s;
    }

    .btn1_1 {
        opacity: 0;
        pointer-events: none;
        background-image: url(https://cdn-icons-png.flaticon.com/512/733/733740.png);
        background-repeat: no-repeat;
        background-size: contain;
        width: 3rem;
        height: 3rem;
        border: none;
        background-color: transparent;
        transition: all ease 1s;
    }

    .btn2 {
        background-image: url(https://cdn-icons-png.flaticon.com/512/2920/2920093.png);
        background-repeat: no-repeat;
        background-size: contain;
        width: 3rem;
        height: 3rem;
        border: none;
        background-color: transparent;
        transition: all ease 1s;
    }

    .btn2_1 {
        opacity: 0;
        pointer-events: none;
        background-image: url(https://cdn-icons-png.flaticon.com/512/2920/2920093.png);
        background-repeat: no-repeat;
        background-size: contain;
        width: 3rem;
        height: 3rem;
        border: none;
        background-color: transparent;
        transition: all ease 1s;
    }

    .btnRe {
        opacity: 0;
        pointer-events: none;
        background-image: url(https://cdn-icons-png.flaticon.com/512/5038/5038573.png);
        background-repeat: no-repeat;
        background-size: contain;
        width: 3rem;
        height: 3rem;
        border: none;
        background-color: transparent;
        transition: all ease 1s;
    }

    .btnRe_1 {
        background-image: url(https://cdn-icons-png.flaticon.com/512/5038/5038573.png);
        background-repeat: no-repeat;
        background-size: contain;
        width: 3rem;
        height: 3rem;
        border: none;
        background-color: transparent;
        transition: all ease 1s;
    }
</style>

<body>

    <div id="textarea">
        <textarea class="textbox">
        </textarea>
    </div>
    <br>
    <button class="btn0" onclick="createEl(0)"></button>
    <button class="btn1" onclick="createEl(1)"></button>
    <button class="btn2" onclick="createEl(2)"></button>
    <button class="btnRe" onclick="reset()"></button>

    <p id="xitem0"></p>
    <p id="yitem0"></p>
    <p id="xitem1"></p>
    <p id="yitem1"></p>
    <p id="xitem2"></p>
    <p id="yitem2"></p>

    <script>

        function reset() {
            stickerNumber = 0;
            $('.btn0_1').removeClass().addClass('btn0');
            $('.btn1_1').removeClass().addClass('btn1');
            $('.btn2_1').removeClass().addClass('btn2');
            $('#item0').remove();
            $('#item1').remove();
            $('#item2').remove();
            $('.btnRe_1').removeClass().addClass('btnRe');


        }

        function remove(props) {
            let a = document.querySelector('#item' + props);
            let b = document.querySelector('#xitem' + props);
            let c = document.querySelector('#yitem' + props);
            a.remove();
            b.innerText = "initialX : ";
            c.innerText = "initialY : ";
            $('.btnRe').removeClass().addClass('btnRe_1');

        }

        let stickerNumber = 0;

        function createEl(props) {
            $('.btnRe_1').removeClass().addClass('btnRe');
            let newElement = document.createElement('div');
            let newElementX = document.createElement('div');

            let textarea = document.querySelector('#textarea');

            newElement.setAttribute('id', 'item' + stickerNumber);
            newElement.setAttribute('class', 'item' + props);

            newElementX.setAttribute('class', 'close');
            newElementX.setAttribute('onclick', 'remove(' + stickerNumber + ')');

            textarea.appendChild(newElement)
            let x = document.querySelector('#item' + stickerNumber);

            x.appendChild(newElementX)

            let dragItem = document.querySelector("#item" + stickerNumber);
            let container = document.querySelector("#textarea");

            let active = false;
            let currentX;
            let currentY;
            let initialX;
            let initialY;
            let xOffset = 0;
            let yOffset = 0;

            container.addEventListener("touchstart", dragStart, false);
            container.addEventListener("touchend", dragEnd, false);
            container.addEventListener("touchmove", drag, false);
            container.addEventListener("mousedown", dragStart, false);
            container.addEventListener("mouseup", dragEnd, false);
            container.addEventListener("mousemove", drag, false);

            function dragStart(e) {
                if (e.type === "touchstart") {
                    initialX = e.touches[0].clientX - xOffset;
                    initialY = e.touches[0].clientY - yOffset;
                } else {
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                }
                if (e.target === dragItem) {
                    active = true;
                }
            }

            function dragEnd(e) {
                initialX = currentX;
                initialY = currentY;
                console.log(initialX, initialY)
                $('#x' + e.target.id).html("initialX : " + initialX)
                $('#y' + e.target.id).html("initialY : " + initialY)
                active = false;
                dragItem.style.position = "absolute";
            }

            function drag(e) {
                if (active) {
                    e.preventDefault();
                    if (e.type === "touchmove") {
                        currentX = e.touches[0].clientX - initialX;
                        currentY = e.touches[0].clientY - initialY;
                    } else {
                        currentX = e.clientX - initialX;
                        currentY = e.clientY - initialY;
                    }
                    xOffset = currentX;
                    yOffset = currentY;

                    if (currentX >= 145 || currentY >= 135 || currentX <= -145 || currentY <= -135) {
                        alert('Please put a sticker on the letter paper.')
                    } else {
                        setTranslate(currentX, currentY, dragItem);
                    }

                }
            }


            function setTranslate(xPos, yPos, el) {
                el.style.transform = "translate3d(" + xPos + "px, " + yPos + "px, 0)";
                el.style.position = "relative";

            }


            $('.btn' + props).removeClass().addClass('btn' + props + '_1');


            stickerNumber++
        };

    </script>
</body>

</html>